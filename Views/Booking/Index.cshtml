@{
    ViewData["Title"] = "Book a Table - Spice Heaven";
}

<div class="booking-header">
    <div class="container">
        <h1 class="text-center mb-4">Reserve Your Table</h1>
        <p class="text-center text-white mb-5">Experience the perfect dining atmosphere</p>
    </div>
</div>

<div class="booking-content py-5">
    <div class="container">
        <div class="row">
            <div class="col-lg-6 mb-4 mb-lg-0">
                <div class="booking-form-container">
                    <form id="bookingForm" class="booking-form">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="name" placeholder="Your Name" required>
                                    <label for="name">Your Name</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="email" class="form-control" id="email" placeholder="Email" required>
                                    <label for="email">Email Address</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="tel" class="form-control" id="phone" placeholder="Phone" required>
                                    <label for="phone">Phone Number</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <select class="form-select" id="guests" required>
                                        <option value="">Select guests</option>
                                        <option value="1">1 Person</option>
                                        <option value="2">2 People</option>
                                        <option value="3">3 People</option>
                                        <option value="4">4 People</option>
                                        <option value="5">5 People</option>
                                        <option value="6">6 People</option>
                                        <option value="7+">7+ People</option>
                                    </select>
                                    <label for="guests">Number of Guests</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <input type="date" class="form-control" id="date" required>
                                    <label for="date">Date</label>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-floating">
                                    <select class="form-select" id="time" required>
                                        <option value="">Select time</option>
                                        <option value="12:00">12:00 PM</option>
                                        <option value="12:30">12:30 PM</option>
                                        <option value="13:00">1:00 PM</option>
                                        <option value="13:30">1:30 PM</option>
                                        <option value="19:00">7:00 PM</option>
                                        <option value="19:30">7:30 PM</option>
                                        <option value="20:00">8:00 PM</option>
                                        <option value="20:30">8:30 PM</option>
                                        <option value="21:00">9:00 PM</option>
                                    </select>
                                    <label for="time">Time</label>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="form-floating">
                                    <textarea class="form-control" id="specialRequests" style="height: 100px" placeholder="Special Requests"></textarea>
                                    <label for="specialRequests">Special Requests (Optional)</label>
                                </div>
                            </div>
                            <div class="col-12">
                                <button type="submit" class="btn btn-primary w-100 btn-lg">
                                    Reserve Table
                                    <i class="fas fa-calendar-check ms-2"></i>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="booking-info">
                    <div class="restaurant-layout mb-4">
                        <h4 class="mb-3">Restaurant Layout</h4>
                        <div class="layout-container">
                            <!-- Interactive restaurant layout will be rendered here -->
                            <div class="layout-grid" id="layoutGrid"></div>
                        </div>
                    </div>
                    <div class="booking-features">
                        <h4 class="mb-3">Features & Amenities</h4>
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="feature-card">
                                    <i class="fas fa-wifi"></i>
                                    <span>Free WiFi</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="feature-card">
                                    <i class="fas fa-parking"></i>
                                    <span>Free Parking</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="feature-card">
                                    <i class="fas fa-wheelchair"></i>
                                    <span>Wheelchair Accessible</span>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="feature-card">
                                    <i class="fas fa-air-conditioner"></i>
                                    <span>Air Conditioned</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Styles {
    <style>
        .booking-header {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)),
                        url('https://images.unsplash.com/photo-1517248135467-4c7edcad34c4');
            background-size: cover;
            background-position: center;
            padding: 100px 0 50px;
            color: white;
        }

        .booking-form-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .form-floating > .form-control,
        .form-floating > .form-select {
            height: 60px;
        }

        .form-floating > label {
            padding: 1rem 0.75rem;
        }

        .booking-info {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .layout-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            height: 300px;
            position: relative;
        }

        .layout-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            height: 100%;
        }

        .table-spot {
            background: #e9ecef;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .table-spot:hover {
            background: #dee2e6;
        }

        .table-spot.available {
            background: #28a745;
            color: white;
        }

        .table-spot.reserved {
            background: #dc3545;
            color: white;
            cursor: not-allowed;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .feature-card i {
            font-size: 24px;
            color: #ff4757;
            margin-bottom: 10px;
            display: block;
        }

        .btn-primary {
            background: #ff4757;
            border: none;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            background: #ff2e44;
            transform: scale(1.05);
        }
    </style>
}

@section Scripts {
    <script>
        $(document).ready(function() {
            // Initialize date picker with min date as today
            const today = new Date().toISOString().split('T')[0];
            $('#date').attr('min', today);

            // Generate restaurant layout
            const tables = [
                { id: 1, seats: 2, status: 'available' },
                { id: 2, seats: 2, status: 'reserved' },
                { id: 3, seats: 4, status: 'available' },
                { id: 4, seats: 4, status: 'available' },
                { id: 5, seats: 6, status: 'reserved' },
                { id: 6, seats: 2, status: 'available' },
                { id: 7, seats: 4, status: 'available' },
                { id: 8, seats: 8, status: 'available' }
            ];

            const layoutGrid = $('#layoutGrid');
            tables.forEach(table => {
                const tableElement = $('<div>')
                    .addClass(`table-spot ${table.status}`)
                    .html(`<i class="fas fa-chair"></i><br>Table ${table.id}<br>${table.seats} seats`);
                layoutGrid.append(tableElement);
            });

            // Real-time availability checking
            $('#date, #time').change(function() {
                const date = $('#date').val();
                const time = $('#time').val();
                
                if (date && time) {
                    // Simulate API call to check availability
                    checkAvailability(date, time);
                }
            });

            function checkAvailability(date, time) {
                // Simulate API response
                setTimeout(() => {
                    $('.table-spot').each(function() {
                        const random = Math.random();
                        $(this)
                            .removeClass('available reserved')
                            .addClass(random > 0.3 ? 'available' : 'reserved');
                    });
                }, 500);
            }

            // Form submission
            $('#bookingForm').submit(function(e) {
                e.preventDefault();
                
                const formData = {
                    name: $('#name').val(),
                    email: $('#email').val(),
                    phone: $('#phone').val(),
                    guests: $('#guests').val(),
                    date: $('#date').val(),
                    time: $('#time').val(),
                    specialRequests: $('#specialRequests').val()
                };

                // Show loading state
                const submitBtn = $(this).find('button[type="submit"]');
                const originalText = submitBtn.html();
                submitBtn.html('<i class="fas fa-spinner fa-spin"></i> Processing...').prop('disabled', true);

                // Simulate API call
                setTimeout(() => {
                    // Success message
                    Swal.fire({
                        icon: 'success',
                        title: 'Reservation Confirmed!',
                        text: 'We have sent a confirmation email with your booking details.',
                        confirmButtonColor: '#ff4757'
                    }).then(() => {
                        // Reset form
                        $('#bookingForm')[0].reset();
                        submitBtn.html(originalText).prop('disabled', false);
                    });
                }, 1500);
            });
        });
    </script>
} 